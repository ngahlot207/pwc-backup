<template>
    
    <lightning-card title="SPDC and Pre EMI" >
        <!-- <div id="containerDiv" onmousemove={handlemousemove} onmouseup={handlemouseup}
           ondblclick={handledblclickresizable}
           class="slds-table_header-fixed_container slds-border_right slds-border_left tableScroll"
           onscroll={tableOuterDivScrolled}>
              <div id="tableViewInnerDiv" class="slds-scrollable_y tableViewInnerDiv slds-scrollable">
                  <table class="slds-table slds-table_resizable slds-table_bordered slds-table_header-fixed slds-table_resizable-cols slds-table_fixed-layout slds-max-medium-table_stacked-horizontal" onscroll={tableScrolled}>
                    <thead>
                      <tr>
                        <th title="Delete" class="slds-is-resizable dv-dynamic-width fixedWidth fixedPosition" scope="col">
                            <div class="slds-cell-fixed fixedWidth">
                            <a class="slds-th__action slds-text-link--reset">
                              <span class="slds-truncate">Delete</span>
                            </a>
                            <div class="slds-resizable">
                                <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                    <span class="slds-resizable__divider"></span>
                                </span>
                            </div>
                            </div>
                          </th>

                          <th title="Same as Repayment" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                            <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset checkbox-label" href="#" role="button"
                                tabindex="0">
                                <span class="slds-truncate">Same as Repayment</span>
                                </a>
                              <div class="slds-resizable">
                                <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                  <span class="slds-resizable__divider"></span>
                                </span>
                              </div>
                            </div>
                          </th>
                        <th title="Cheque Number from" class="slds-is-resizable dv-dynamic-width fixedWidth fixedPosition" scope="col">
                          <div class="slds-cell-fixed fixedWidth">
                          <a class="slds-th__action slds-text-link--reset">
                            <span class="slds-truncate">Cheque Number from</span>
                          </a>
                          <div class="slds-resizable">
                              <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                  <span class="slds-resizable__divider"></span>
                              </span>
                          </div>
                          </div>
                        </th>
                        <th title="Cheque Number to" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                          <div class="slds-cell-fixed fixedWidth">
                          <a class="slds-th__action slds-text-link--reset">
                            <span class="slds-truncate">Cheque Number to</span>
                          </a>
                          <div class="slds-resizable">
                              <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                  <span class="slds-resizable__divider"></span>
                              </span>
                          </div>
                          </div>
                        </th>
                        <th title="No. of cheques" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                          <div class="slds-cell-fixed fixedWidth">
                          <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                            <span class="slds-truncate">No. of cheques</span>
                          </a>
                          <div class="slds-resizable">
                              <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                  <span class="slds-resizable__divider"></span>
                              </span>
                          </div>
                          </div>
                        </th>
                        <th title="MICR Code" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                          <div class="slds-cell-fixed fixedWidth">
                          <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                            <span class="slds-truncate">MICR Code</span>
                          </a>
                          <div class="slds-resizable">
                              <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                  <span class="slds-resizable__divider"></span>
                              </span>
                          </div>
                          </div>
                        </th>
                        
                          <th title="Bank Name" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                              <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                <span class="slds-truncate">Bank Name</span>
                              </a>
                              <div class="slds-resizable">
                                  <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                      <span class="slds-resizable__divider"></span>
                                  </span>
                              </div>
                              </div>
                            </th>
      
                            
                            
                            <th title="Bank Branch" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                              <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                <span class="slds-truncate">Bank Branch</span>
                              </a>
                              <div class="slds-resizable">
                                  <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                      <span class="slds-resizable__divider"></span>
                                  </span>
                              </div>
                              </div>
                            </th>
                        
                        
                          <th title="PDC By Name" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                            <div class="slds-cell-fixed fixedWidth">
                            <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                              <span class="slds-truncate">PDC By Name</span>
                            </a>
                            <div class="slds-resizable">
                                <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                    <span class="slds-resizable__divider"></span>
                                </span>
                            </div>
                            </div>
                          </th>
                        
                        
                            <th title="IFSC Code" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                              <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                <span class="slds-truncate">IFSC Code</span>
                              </a>
                              <div class="slds-resizable">
                                  <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                      <span class="slds-resizable__divider"></span>
                                  </span>
                              </div>
                              </div>
                            </th>
                            <th title="Customer A/C Number" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                              <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                <span class="slds-truncate">Customer A/C Number</span>
                                </a>
                              <div class="slds-resizable">
                                  <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                      <span class="slds-resizable__divider"></span>
                                  </span>
                              </div>
                              </div>
                            </th>
                          
                          
                            <th title="Cheque Purpose" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                              <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                <span class="slds-truncate">Cheque Purpose</span>
                              </a>
                              <div class="slds-resizable">
                                  <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                      <span class="slds-resizable__divider"></span>
                                  </span>
                              </div>
                              </div>
                            </th>
    
                            <th title="Cheque Amount" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                              <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                <span class="slds-truncate">Cheque Amount</span>
                              </a>
                              <div class="slds-resizable">
                                  <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                      <span class="slds-resizable__divider"></span>
                                  </span>
                              </div>
                              </div>
                            </th>
    
                            <th title="Cheque Available for EMI TILL" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                              <div class="slds-cell-fixed fixedWidth">
                              <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                <span class="slds-truncate">Cheque Available for EMI TILL</span>
                              </a>
                              <div class="slds-resizable">
                                  <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                      <span class="slds-resizable__divider"></span>
                                  </span>
                              </div>
                              </div>
                            </th>
                            <th title="Pending Cheques will be collected on" class="slds-is-resizable dv-dynamic-width fixedWidth" scope="col">
                                <div class="slds-cell-fixed fixedWidth">
                                <a class="slds-th__action slds-text-link--reset" href="#" role="button" tabindex="0">
                                  <span class="slds-truncate">Pending Cheques will be collected on</span>
                                </a>
                                <div class="slds-resizable">
                                    <span class="slds-resizable__handle" onmousedown={handlemousedown}>
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                                </div>
                                </div>
                              </th>
                        
                        
                      </tr>
                    </thead> -->
                    <div class="container slds-scrollable tableMinHeight" >
                      <table class="slds-table slds-table_bordered slds-p-around_medium ">
                          <thead>
                              <tr>
                              <th style="background-color: #F3F2F2;width: 10%;" scope="col">Delete</th>
                              <th style="background-color: #F3F2F2;width: 10%;" scope="col">Same as Repayment</th>
                             
                              <th style="background-color: #F3F2F2;width: 10%;  padding: 0 50px;" scope="col"><label id="id-01"> Cheque Number from </label></th>
                              <th style="background-color: #F3F2F2;width: 10%;  padding: 0 50px;" scope="col"><label id="id-02">Cheque Number to</label></th>
                              <th style="background-color: #F3F2F2;width: 10%;  padding: 0 50px;" scope="col">No. of cheques</th>
                              <th style="background-color: #F3F2F2;width: 10%;  padding: 0 50px;" scope="col"><label id="id-03">MICR Code</label></th>
                              <th style="background-color: #F3F2F2;width: 10%; padding: 0 50px" scope="col">Bank Name</th>                        
                              <th style="background-color: #F3F2F2;width: 10%; padding: 0 50px" scope="col">Bank Branch </th>
                              <th style="background-color: #F3F2F2;width: 10%; padding: 0 50px" scope="col">PDC By Name</th>
                              <th style="background-color: #F3F2F2;width: 10%;padding: 0 50px" scope="col">IFSC Code</th>
                              <th style="background-color: #F3F2F2;width: 10%; padding: 0 50px" scope="col"> <label id="id-04"> Customer A/C Number</label></th>
                              <th style="background-color: #F3F2F2;width: 15%; padding: 0 50px" scope="col"><label id="id-05"> Cheque Purpose </label></th>
                              <th style="background-color: #F3F2F2;width: 10%; padding: 0 40px" scope="col"><label id="id-06">Cheque Amount</label></th>
                              <!-- <th style="background-color: #F3F2F2;width: 10%; padding: 0 40px" scope="col">Cheque Available for EMI TILL</th> -->
                              <!-- <th style="background-color: #F3F2F2;width: 10%; padding: 0 40px" scope="col">Pending Cheques will be collected on</th> -->
                              
                              </tr>
                              </thead>
          <tbody>
            <template for:each={AllSPDCRecords} for:item="SPDCIterator" for:index="index">
                <tr key={SPDCIterator.cDId} aria-selected="false" class="slds-hint-parent">
  
                  <td style="background-color: #F3F2F2;" scope="row">
                      <!-- <div class="slds-truncate" title="PAN">PAN</div> -->
                      
                          <!-- <lightning-button variant="destructive" label="Delete" data-index={index} data-name="Delete" title="Delete" onclick={handleDeleteSPDC} read-only={disableMode} disabled={disableMode} class="slds-m-left_x-small"></lightning-button> -->
                          <!-- <lightning-icon icon-name='utility:delete' alternative-text='delete' variant='error' class="slds-m-top--large slds-float_left" size='small' title='delete' data-index={index} data-name="Delete" onclick={handleDeleteSPDC}  disabled={disableMode}></lightning-icon> -->
                          <lightning-button-icon icon-name='utility:delete' alternative-text='delete' variant='error' class="pointerClass custom-css slds-m-top--large slds-float_left" size='small' title='delete' data-index={index} data-name="Delete" onclick={handleDeleteSPDC}  disabled={disableMode}></lightning-button-icon>

                      
                    </td>

                    <td style="background-color: #F3F2F2;" scope="row">
                        <!-- <div class="slds-truncate slds-text-align_center" title="OSV"> -->
                          <lightning-input variant="label-hidden"  type="checkbox"
                            checked={SPDCIterator.Same_As_Repayment_Account__c} data-name="Same_As_Repayment_Account__c" data-index={index} data-fieldname={Same_As_Repayment_Account__c} onchange={checkboxHandler} read-only={disableMode} disabled={disableMode}></lightning-input>
                        
                      </td>
  
                  <th style="background-color: #F3F2F2;" scope="row">
                    
                      <!-- <a href="#" tabindex="0">Proof Of Identity</a> -->
                      <!-- {MSMEIterator.ApplType__c} -->
                      <lightning-input type="text"  onblur={handleInputChangeSPDC}  value={SPDCIterator.Cheque_Number_From__c}
                  data-name="Cheque_Number_From__c" disabled={disableMode}  read-only={disableMode} pattern="^[0-9\s]+$" message-when-pattern-mismatch={messageMismatchError} data-index={index} data-fieldname={Cheque_Number_From__c} required={required} 
                  variant="label-hidden" data-id="chequeFrom"></lightning-input>
              
                    
                  </th>
                  <td style="background-color: #F3F2F2;" scope="row">
                    <!-- <div class="slds-truncate" title="PAN">PAN</div> -->
                    
                      <lightning-input type="text"  onblur={handleInputChangeSPDC}  value={SPDCIterator.Cheque_Number_To__c}
                  data-name="Cheque_Number_To__c" disabled={disableMode}  read-only={disableMode} pattern="^[0-9\s]+$" message-when-pattern-mismatch={messageMismatchError} data-index={index} data-fieldname={Cheque_Number_To__c} required={required} 
                  variant="label-hidden" data-id="chequeTo"></lightning-input>
              
                    
                  </td>
                  <td style="background-color: #F3F2F2;" scope="row">
                    
                      <lightning-input type="text"   value={SPDCIterator.No_of_Cheques__c}
                      data-name="No_of_Cheques__c" disabled="true" required={requiredFlag} variant="label-hidden" read-only={disableMode} pattern="^[0-9\s]+$" message-when-pattern-mismatch={messageMismatchError} data-index={index} data-fieldname={No_of_Cheques__c}></lightning-input>
                  
                    
                  </td>
                 
                  
                <!-- <template> -->
                    <!-- <template lwc:if={isCheck}> -->
                        <template lwc:if={SPDCIterator.Same_As_Repayment_Account__c}>
                        <td style="background-color: #F3F2F2; padding: 0 50px" scope="row" >
                        
                        <!-- <lightning-input type="text" label="MICR_Code__c" onchange={handleInputChange}  value={PDCIterator.MICR_Code__c}
                        data-name="MICR_Code__c" disabled={disableMode} required={requiredFlag} read-only={disableMode} pattern="^[A-Za-z\s]+$" message-when-pattern-mismatch={messageMismatchError} data-index={index} data-fieldname={Rel}></lightning-input>
                    -->
                            {SPDCIterator.MICR_Code__c}
    
                        
                        </td>
            
                        <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                           
                            {SPDCIterator.Bank_Name__c}
                           
                        </td>
                        <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                            
                            {SPDCIterator.Bank_Branch__c}
                          
                        </td>
                    </template>
                    <template lwc:else>
                      <template lwc:if={SPDCIterator.MICR_Code__c}>
                        <td style="background-color: #F3F2F2;" scope="row"><c-custom-lookup 
                      
                        field-name="MICR_Code__c"
                        selected-icon-name="standard:identifier"
                        object-api-name="MICRCodeMstr__c"
                        field-api-name="MICRCode__c"                            
                        selected-record-id={SPDCIterator.MICR_Code__c}
                        selected-record-name={SPDCIterator.MICR_Code__c}
                        onselect={handleValueSelect}
                        index={index}
                        read-only={disableMode} 
                        disabled={disableMode}
                        required={required} 
                            variant="label-hidden"
                        ></c-custom-lookup></td></template>
                        <template lwc:else>
                          <td style="background-color: #F3F2F2;" scope="row"><c-custom-lookup 
                      
                            field-name="MICR_Code__c"
                            selected-icon-name="standard:identifier"
                            object-api-name="MICRCodeMstr__c"
                            field-api-name="MICRCode__c"                            
                            selected-record-id=''
                            selected-record-name=''
                            onselect={handleValueSelect}
                            index={index}
                            read-only={disableMode} 
                            disabled={disableMode}
                            required={required} 
                            variant="label-hidden"
                            ></c-custom-lookup></td>
                        </template>
                        <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                            
                            {SPDCIterator.Bank_Name__c}
                            
                        </td>
                      
                        <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                           
                            {SPDCIterator.Bank_Branch__c}
                           
                        </td>
                    </template>
                <!-- </template> -->
                  <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                    
                      {SPDCIterator.PDCbyName}
                   
                  </td>
                  <template lwc:if={SPDCIterator.Same_As_Repayment_Account__c}>
                  <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                    
                      {SPDCIterator.IFSC_Code__c}
                    
                  </td>
                  <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                   
                    {SPDCIterator.Account_Number__c}
             
                </td>
                  
                
                </template>
                <template lwc:else>
                    <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">
                       
                          {SPDCIterator.IFSC_Code__c}
                       
                      </td>
                      <td style="background-color: #F3F2F2; padding: 0 50px" scope="row">

                        <lightning-input type="text"  onchange={handleInputChangeSPDC}  value={SPDCIterator.Account_Number__c}
                      data-name="Account_Number__c" disabled={disableMode}  read-only={disableMode} pattern="^[0-9\s]+$" message-when-pattern-mismatch={messageMismatchError} data-index={index} data-fieldname={Account_Number__c} required={required} 
                      variant="label-hidden"></lightning-input>
                  
                      </td>
                </template>
                  
                  
                  <td style="background-color: #F3F2F2;" scope="row">
                    <!-- <div class="slds-truncate" title={SPDCIterator.Cheque_Purpose__c}>
                      <select name="Cheque_Purpose__c	"  value={SPDCIterator.Cheque_Purpose__c} data-name="Cheque_Purpose__c" class="slds-select" data-index={index} data-field="Cheque_Purpose__c" onchange={handleInputChangeSPDC}>
                          <template for:each={ChequePurposeOptions} for:item="opt">
                             <option key={opt.value} value={opt.value}>{opt.label}</option> 
                          </template>
                      </select> 
                      
                    </div> -->
                    <lightning-combobox
                                                
                                                name="Cheque_Purpose__c"                                                                                                                                              
                                                value={SPDCIterator.Cheque_Purpose__c}                                                    
                                                data-name="Cheque_Purpose__c"
                                                options={ChequePurposeOptions}
                                                data-index={index}
                                                data-field="Cheque_Purpose__c"
                                                onchange={handleInputChangeSPDC}
                                                read-only={disableMode} 
                                                disabled={disableMode}
                                                required={required} 
                                                variant="label-hidden">
                                                
                                            </lightning-combobox>
                  </td>
                  <td style="background-color: #F3F2F2;" scope="row">
                    
                      <lightning-input type="text" onchange={handleInputChangeSPDC}  value={SPDCIterator.Cheque_Amount__c}
                      data-name="Cheque_Amount__c" disabled={disableMode} required={required} 
                      variant="label-hidden" read-only={disableMode} pattern="^[0-9\s]+$" message-when-pattern-mismatch={messageMismatchError} data-index={index} data-fieldname={Cheque_Amount__c}></lightning-input>
                  
                   
                  </td>
                  <!-- <td style="background-color: #F3F2F2;" scope="row">
               
                      <lightning-input  placeholder="DD/MM/YYYY" type="date" value={SPDCIterator.Cheque_Available_EMI__c} data-name="Cheque_Available_EMI__c" onchange={handleInputChangeSPDC} data-field="Cheque_Available_EMI__c"  data-index={index} data-fieldname={Cheque_Available_EMI__c} read-only={disableMode} disabled={disableMode}></lightning-input>
                    
                  </td> -->
                  
                  <!-- <td style="background-color: #F3F2F2;" scope="row">
                      
                        <lightning-input type="text" onchange={handleInputChangeSPDC}  value={SPDCIterator.Pending_Cheque__c}
                        data-name="Pending_Cheque__c" disabled={disableMode} required={requiredFlag} read-only={disableMode} pattern="^[0-9\s]+$" message-when-pattern-mismatch={messageMismatchError} data-index={index} data-fieldname={Pending_Cheque__c}></lightning-input>
                    
                    
                    </td> -->
                </tr>
              </template>
          </tbody>
        </table>
      </div>
      <!-- </div> -->
    </lightning-card>
    <lightning-layout>
        <lightning-layout-item size="12">
        <!-- <template lwc:if={isYes}> -->
            <!-- <template> -->
            <div class="center slds-clearfix">
        <div class="slds-float_right"> 
            <lightning-button
            label="Add Row"       
            variant="brand"
            onclick={handleSPDCAddRow}
            disabled={disableMode}
            read-only={disableMode} 
            
            ></lightning-button>
        </div></div>        
        <!-- </template> -->
        </lightning-layout-item>
             </lightning-layout>
     
<!-- modal for record delete -->
<template if:true={isModalOpen}>
  <!-- Modal/Popup Box LWC starts here -->
  <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
    aria-describedby="modal-content-id-1" class="my-modal slds-modal slds-fade-in-open">
    <div class="slds-modal__container">
      <!-- Modal/Popup Box LWC header here -->
      <header class="slds-modal__header">
        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close"
          onclick={isCloseModal}>
          <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
            size="small"></lightning-icon>
          <span class="slds-assistive-text">Close</span>
        </button>
        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Delete?</h2>
      </header>
      <!-- Modal/Popup Box LWC body starts here -->
      <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
        <p style="text-align:center;"><b>{removeModalMessage}</b></p>
      </div>
      <!-- Modal/Popup Box LWC footer starts here -->
      <footer class="slds-modal__footer">
        <button class="slds-button slds-button_brand" 
          onclick={handleRemoveRecord} title="Yes">Yes</button>
        <button class="slds-button slds-button_neutral" onclick={isCloseModal} title="No">No</button>
      </footer>
    </div>
  </section>
  <div class="slds-backdrop slds-backdrop_open"></div>
</template>
</template>